<!DOCTYPE html>
<html class="client-nojs" lang="en" dir="ltr">
<head>
<meta charset="UTF-8"/>
<title>Portal:Toolforge/Admin/Kubernetes/jobs - Wikitech</title>
<script>document.documentElement.className="client-js";RLCONF={"wgBreakFrames":false,"wgSeparatorTransformTable":["",""],"wgDigitTransformTable":["",""],"wgDefaultDateFormat":"dmy","wgMonthNames":["","January","February","March","April","May","June","July","August","September","October","November","December"],"wgRequestId":"c8c42efc-6e76-45fc-98bb-4a729f30da84","wgCSPNonce":false,"wgCanonicalNamespace":"","wgCanonicalSpecialPageName":false,"wgNamespaceNumber":0,"wgPageName":"Portal:Toolforge/Admin/Kubernetes/jobs","wgTitle":"Portal:Toolforge/Admin/Kubernetes/jobs","wgCurRevisionId":1959213,"wgRevisionId":1959213,"wgArticleId":448850,"wgIsArticle":true,"wgIsRedirect":false,"wgAction":"view","wgUserName":null,"wgUserGroups":["*"],"wgCategories":[],"wgPageContentLanguage":"en","wgPageContentModel":"wikitext","wgRelevantPageName":"Portal:Toolforge/Admin/Kubernetes/jobs","wgRelevantArticleId":448850,"wgIsProbablyEditable":false,"wgRelevantPageIsProbablyEditable":false,"wgRestrictionEdit":[],
"wgRestrictionMove":[],"wgVisualEditor":{"pageLanguageCode":"en","pageLanguageDir":"ltr","pageVariantFallbacks":"en"},"wgMFDisplayWikibaseDescriptions":{"search":true,"nearby":true,"watchlist":true,"tagline":false},"wgWMESchemaEditAttemptStepOversample":false,"wgWMEPageLength":20000,"wgMediaViewerOnClick":true,"wgMediaViewerEnabledByDefault":true,"wgULSCurrentAutonym":"English","wgEditSubmitButtonLabelPublish":true,"wgDiscussionToolsFeaturesEnabled":{"replytool":true,"newtopictool":false,"sourcemodetoolbar":true,"topicsubscription":false,"autotopicsub":false},"wgDiscussionToolsFallbackEditMode":"visual","wgULSPosition":"personal","wgULSisCompactLinksEnabled":true,"wgSiteNoticeId":"2.0"};RLSTATE={"ext.gadget.enwp-boxes":"ready","site.styles":"ready","user.styles":"ready","user":"ready","user.options":"loading","ext.pygments":"ready","ext.discussionTools.init.styles":"ready","skins.vector.styles.legacy":"ready","jquery.tablesorter.styles":"ready","jquery.makeCollapsible.styles":"ready",
"ext.visualEditor.desktopArticleTarget.noscript":"ready","ext.uls.pt":"ready","ext.dismissableSiteNotice.styles":"ready"};RLPAGEMODULES=["site","mediawiki.page.ready","jquery.tablesorter","jquery.makeCollapsible","mediawiki.toc","skins.vector.legacy.js","mmv.head","mmv.bootstrap.autostart","ext.visualEditor.desktopArticleTarget.init","ext.visualEditor.targetLoader","ext.eventLogging","ext.wikimediaEvents","ext.gadget.site","ext.discussionTools.init","ext.uls.compactlinks","ext.uls.interface","ext.dismissableSiteNotice"];</script>
<script>(RLQ=window.RLQ||[]).push(function(){mw.loader.implement("user.options@1i9g4",function($,jQuery,require,module){mw.user.tokens.set({"patrolToken":"+\\","watchToken":"+\\","csrfToken":"+\\"});});});</script>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=ext.discussionTools.init.styles%7Cext.dismissableSiteNotice.styles%7Cext.pygments%7Cext.uls.pt%7Cext.visualEditor.desktopArticleTarget.noscript%7Cjquery.makeCollapsible.styles%7Cjquery.tablesorter.styles%7Cskins.vector.styles.legacy&amp;only=styles&amp;skin=vector"/>
<script async="" src="/w/load.php?lang=en&amp;modules=startup&amp;only=scripts&amp;raw=1&amp;skin=vector"></script>
<meta name="ResourceLoaderDynamicStyles" content=""/>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=ext.gadget.enwp-boxes&amp;only=styles&amp;skin=vector"/>
<link rel="stylesheet" href="/w/load.php?lang=en&amp;modules=site.styles&amp;only=styles&amp;skin=vector"/>
<meta name="generator" content="MediaWiki 1.39.0-wmf.10"/>
<meta name="referrer" content="origin"/>
<meta name="referrer" content="origin-when-crossorigin"/>
<meta name="referrer" content="origin-when-cross-origin"/>
<meta name="format-detection" content="telephone=no"/>
<meta property="og:title" content="Portal:Toolforge/Admin/Kubernetes/jobs - Wikitech"/>
<meta property="og:type" content="website"/>
<link rel="preconnect" href="//upload.wikimedia.org"/>
<link rel="shortcut icon" href="/static/favicon/wikitech.ico"/>
<link rel="search" type="application/opensearchdescription+xml" href="/w/opensearch_desc.php" title="Wikitech (en)"/>
<link rel="EditURI" type="application/rsd+xml" href="//wikitech.wikimedia.org/w/api.php?action=rsd"/>
<link rel="license" href="https://creativecommons.org/licenses/by-sa/3.0/"/>
<link rel="canonical" href="https://wikitech.wikimedia.org/wiki/Portal:Toolforge/Admin/Kubernetes/jobs"/>
</head>
<body class="ext-discussiontools-replytool-enabled ext-discussiontools-sourcemodetoolbar-enabled mediawiki ltr sitedir-ltr mw-hide-empty-elt ns-0 ns-subject page-Portal_Toolforge_Admin_Kubernetes_jobs rootpage-Portal_Toolforge skin-vector action-view skin-vector-legacy"><div id="mw-page-base" class="noprint"></div>
<div id="mw-head-base" class="noprint"></div>
<div id="content" class="mw-body" role="main">
	<a id="top"></a>
	<div id="siteNotice"><div id="mw-dismissablenotice-anonplace"></div><script>(function(){var node=document.getElementById("mw-dismissablenotice-anonplace");if(node){node.outerHTML="\u003Cdiv class=\"mw-dismissable-notice\"\u003E\u003Cdiv class=\"mw-dismissable-notice-close\"\u003E[\u003Ca tabindex=\"0\" role=\"button\"\u003Edismiss\u003C/a\u003E]\u003C/div\u003E\u003Cdiv class=\"mw-dismissable-notice-body\"\u003E\u003Cdiv id=\"localNotice\"\u003E\u003Cdiv class=\"sitenotice\" lang=\"en\" dir=\"ltr\"\u003E\u003Cdiv class=\"center\"\u003E\u003Ca href=\"https://www.mediawiki.org/wiki/Wikimedia_Hackathon_2022\" class=\"extiw\" title=\"mw:Wikimedia Hackathon 2022\"\u003EWikimedia Hackathon 2022\u003C/a\u003E will be held \u003Ci\u003Eonline\u003C/i\u003E May 20-22, 2022.\u003C/div\u003E\u003C/div\u003E\u003C/div\u003E\u003C/div\u003E\u003C/div\u003E";}}());</script></div>
	<div class="mw-indicators">
	</div>
	<h1 id="firstHeading" class="firstHeading mw-first-heading">Portal:Toolforge/Admin/Kubernetes/jobs</h1>
	<div id="bodyContent" class="vector-body">
		<div id="siteSub" class="noprint">From Wikitech</div>
		<div id="contentSub"><span class="subpages">&lt; <a href="/wiki/Portal:Toolforge" title="Portal:Toolforge">Portal:Toolforge</a>&lrm; | <a href="/wiki/Portal:Toolforge/Admin" title="Portal:Toolforge/Admin">Admin</a>&lrm; | <a href="/wiki/Portal:Toolforge/Admin/Kubernetes" title="Portal:Toolforge/Admin/Kubernetes">Kubernetes</a></span></div>
		<div id="contentSub2"></div>
		
		<div id="jump-to-nav"></div>
		<a class="mw-jump-link" href="#mw-head">Jump to navigation</a>
		<a class="mw-jump-link" href="#searchInput">Jump to search</a>
		<div id="mw-content-text" class="mw-body-content mw-content-ltr" lang="en" dir="ltr"><div class="mw-parser-output"><div style="float:right; clear:right; border:1px solid #999; border-radius: .5em; background-color:#eee; background-image: linear-gradient(#ddd, #eee); font-size:85%; text-align:center; padding:0.5em; margin-left:1em; margin-bottom:1em; width:12em" class="plainlinks mw-trackedTemplate">Tracked in <a href="https://phabricator.wikimedia.org/" class="extiw" title="phabricator:">Phabricator</a><br/><b><a href="https://phabricator.wikimedia.org/T285944" class="extiw" title="phabricator:T285944"><span class="trakfab-T285944">Task T285944</span></a></b></div>
<p>This page contains information about the Toolforge Jobs Framework, an architecture to support <a href="/wiki/Help:Toolforge/Grid" title="Help:Toolforge/Grid"> grid-like jobs</a> on Toolforge kubernetes.
</p>
<div id="toc" class="toc" role="navigation" aria-labelledby="mw-toc-heading"><input type="checkbox" role="button" id="toctogglecheckbox" class="toctogglecheckbox" style="display:none" /><div class="toctitle" lang="en" dir="ltr"><h2 id="mw-toc-heading">Contents</h2><span class="toctogglespan"><label class="toctogglelabel" for="toctogglecheckbox"></label></span></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="#The_framework"><span class="tocnumber">1</span> <span class="toctext">The framework</span></a>
<ul>
<li class="toclevel-2 tocsection-2"><a href="#Auth"><span class="tocnumber">1.1</span> <span class="toctext">Auth</span></a></li>
<li class="toclevel-2 tocsection-3"><a href="#Ingress_&amp;_TLS"><span class="tocnumber">1.2</span> <span class="toctext">Ingress &amp; TLS</span></a></li>
<li class="toclevel-2 tocsection-4"><a href="#About_logs"><span class="tocnumber">1.3</span> <span class="toctext">About logs</span></a></li>
<li class="toclevel-2 tocsection-5"><a href="#Endpoints"><span class="tocnumber">1.4</span> <span class="toctext">Endpoints</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-6"><a href="#Deployment_and_maintenance"><span class="tocnumber">2</span> <span class="toctext">Deployment and maintenance</span></a>
<ul>
<li class="toclevel-2 tocsection-7"><a href="#jobs-framework-api"><span class="tocnumber">2.1</span> <span class="toctext">jobs-framework-api</span></a>
<ul>
<li class="toclevel-3 tocsection-8"><a href="#deployment"><span class="tocnumber">2.1.1</span> <span class="toctext">deployment</span></a></li>
<li class="toclevel-3 tocsection-9"><a href="#maintenance"><span class="tocnumber">2.1.2</span> <span class="toctext">maintenance</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-10"><a href="#jobs-framework-cli"><span class="tocnumber">2.2</span> <span class="toctext">jobs-framework-cli</span></a>
<ul>
<li class="toclevel-3 tocsection-11"><a href="#deployment_2"><span class="tocnumber">2.2.1</span> <span class="toctext">deployment</span></a></li>
</ul>
</li>
<li class="toclevel-2 tocsection-12"><a href="#jobs-framework-emailer"><span class="tocnumber">2.3</span> <span class="toctext">jobs-framework-emailer</span></a>
<ul>
<li class="toclevel-3 tocsection-13"><a href="#deployment_3"><span class="tocnumber">2.3.1</span> <span class="toctext">deployment</span></a></li>
<li class="toclevel-3 tocsection-14"><a href="#maintenance_2"><span class="tocnumber">2.3.2</span> <span class="toctext">maintenance</span></a></li>
</ul>
</li>
</ul>
</li>
<li class="toclevel-1 tocsection-15"><a href="#API_docs"><span class="tocnumber">3</span> <span class="toctext">API docs</span></a>
<ul>
<li class="toclevel-2 tocsection-16"><a href="#POST_/api/v1/run/"><span class="tocnumber">3.1</span> <span class="toctext">POST /api/v1/run/</span></a></li>
<li class="toclevel-2 tocsection-17"><a href="#GET_/api/v1/show/{name}/"><span class="tocnumber">3.2</span> <span class="toctext">GET /api/v1/show/{name}/</span></a></li>
<li class="toclevel-2 tocsection-18"><a href="#DELETE_/api/v1/delete/{name}"><span class="tocnumber">3.3</span> <span class="toctext">DELETE /api/v1/delete/{name}</span></a></li>
<li class="toclevel-2 tocsection-19"><a href="#GET_/api/v1/list/"><span class="tocnumber">3.4</span> <span class="toctext">GET /api/v1/list/</span></a></li>
<li class="toclevel-2 tocsection-20"><a href="#DELETE_/api/v1/flush/"><span class="tocnumber">3.5</span> <span class="toctext">DELETE /api/v1/flush/</span></a></li>
<li class="toclevel-2 tocsection-21"><a href="#GET_/api/v1/containers/"><span class="tocnumber">3.6</span> <span class="toctext">GET /api/v1/containers/</span></a></li>
</ul>
</li>
<li class="toclevel-1 tocsection-22"><a href="#See_also"><span class="tocnumber">4</span> <span class="toctext">See also</span></a></li>
</ul>
</div>

<h2><span class="mw-headline" id="The_framework" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-The_framework&quot;,&quot;replies&quot;:[&quot;h-Auth-The_framework&quot;,&quot;h-Ingress_&amp;_TLS-The_framework&quot;,&quot;h-About_logs-The_framework&quot;,&quot;h-Endpoints-The_framework&quot;],&quot;headingLevel&quot;:2,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-The_framework"></span>The framework<span data-mw-comment-end="h-The_framework"></span></span></h2>
<p>The framework is called <b>Toolforge Jobs Framework</b> (or <b>TJF</b>). The main component is a REST API to ease end user interaction with Toolforge jobs in the kubernetes cluster. The API abstracts away most of the k8s gory details for configuring, removing, managing and reading status on jobs. The abstraction approach is similar to what is being done with <a href="/wiki/Help:Toolforge/Web" title="Help:Toolforge/Web"> Toolforge webservices</a> (we have the <code>webservice</code> command there), but with an approach that consist on having most of the business logic in an API service.
</p><p>By splitting the software into several components, and introducing an stable API, we aim to reduce maintenance burden by not needing to rebuild all Toolforge docker containers every time we change some internal mechanism (which is the case of the <code>tools-webservice</code> package).
</p>
<figure class="mw-halign-center" typeof="mw:Image"><a href="/wiki/File:Toolforge_jobs.png" class="mw-file-description"><img alt="Toolforge jobs.png" src="//upload.wikimedia.org/wikipedia/labs/thumb/2/21/Toolforge_jobs.png/500px-Toolforge_jobs.png" decoding="async" width="500" height="177" srcset="//upload.wikimedia.org/wikipedia/labs/thumb/2/21/Toolforge_jobs.png/750px-Toolforge_jobs.png 1.5x, //upload.wikimedia.org/wikipedia/labs/thumb/2/21/Toolforge_jobs.png/1000px-Toolforge_jobs.png 2x" data-file-width="1210" data-file-height="428"/></a><figcaption></figcaption></figure>
<p>The framework consists on 3 components:
</p>
<ul><li><b>jobs-framework-api</b> (<a class="external text" href="https://gerrit.wikimedia.org/r/admin/repos/cloud/toolforge/jobs-framework-api">gerrit</a>) (<a class="external text" href="https://gerrit.wikimedia.org/g/cloud/toolforge/jobs-framework-api">gitiles</a>) --- uses <a rel="nofollow" class="external text" href="https://flask-restful.readthedocs.io">flask-restful</a> and runs inside the k8s cluster as a webservice. Offers the REST API that in turn interacts with the k8s API native objects: <code>CronJob</code>, <code>Job</code> and <code>Deployment</code>.</li>
<li><b>jobs-framework-cli</b> (<a class="external text" href="https://gerrit.wikimedia.org/r/admin/repos/cloud/toolforge/jobs-framework-cli">gerrit</a>) (<a class="external text" href="https://gerrit.wikimedia.org/r/plugins/gitiles/cloud/toolforge/jobs-framework-api/">gitiles</a>) --- command line interface to interact with the jobs API service. Typically used by end users in Toolforge bastions.</li>
<li><b>jobs-framework-emailer</b> (<a class="external text" href="https://gerrit.wikimedia.org/r/admin/repos/cloud/toolforge/jobs-framework-emailer">gerrit</a>) (<a class="external text" href="https://gerrit.wikimedia.org/g/cloud/toolforge/jobs-framework-emailer">gitiles</a>) --- a daemon that uses <a rel="nofollow" class="external text" href="https://github.com/kubernetes-client/python">the official k8s python client</a> and <a rel="nofollow" class="external text" href="https://docs.python.org/3/library/asyncio.html">asyncio</a>. It runs inside k8s, listen to pod events, and email users about their jobs activity.</li></ul>
<p>The REST API is freely usable within Toolforge, both bastion servers and kubernetes pods. This means that a running job can interact with the Toolforge jobs API and CRUD other jobs.
</p>
<h3><span class="mw-headline" id="Auth" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-Auth-The_framework&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:3,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-Auth-The_framework"></span>Auth<span data-mw-comment-end="h-Auth-The_framework"></span></span></h3>
<figure class="mw-halign-center" typeof="mw:Image"><a href="/wiki/File:Toolforge_jobs-auth.png" class="mw-file-description"><img alt="Toolforge jobs-auth.png" src="//upload.wikimedia.org/wikipedia/labs/thumb/5/5f/Toolforge_jobs-auth.png/500px-Toolforge_jobs-auth.png" decoding="async" width="500" height="152" srcset="//upload.wikimedia.org/wikipedia/labs/thumb/5/5f/Toolforge_jobs-auth.png/750px-Toolforge_jobs-auth.png 1.5x, //upload.wikimedia.org/wikipedia/labs/thumb/5/5f/Toolforge_jobs-auth.png/1000px-Toolforge_jobs-auth.png 2x" data-file-width="1660" data-file-height="504"/></a><figcaption></figcaption></figure>
<p>To ensure that Toolforge users only manage their own jobs, TJF uses kubernetes certificates for client authentication. These x509 certificates are automatically managed by <code>maintain-kubeusers</code>, and live in each user home directory:
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">toolsbeta.test@toolsbeta-sgebastion-04:~$ </span>egrep client-certificate<span class="se">\|</span>client-key .kube/config
<span class="go">    client-certificate: /data/project/test/.toolskube/client.crt</span>
<span class="go">    client-key: /data/project/test/.toolskube/client.key</span>
<span class="gp">toolsbeta.test@toolsbeta-sgebastion-04:~$ </span>head -1 /data/project/test/.toolskube/client.crt
<span class="go">-----BEGIN CERTIFICATE-----</span>
<span class="gp">toolsbeta.test@toolsbeta-sgebastion-04:~$ </span>head -1 /data/project/test/.toolskube/client.key
<span class="go">-----BEGIN RSA PRIVATE KEY-----</span>
</pre></div>
<p>The <code>jobs-framework-api</code> component needs to know the client certificate <b>CommonName</b>. With this information, <code>jobs-framework-api</code> can <i>supplant</i> the user by reading again the x509 certificates from the user home, and use them to interact with the kubernetes API. This is effectively a TLS proxy that reuses the original certificate.
</p><p>In the current Toolforge webservice setup, TLS termination is done at the nginx front proxy. The front proxy talks to the backends using plain HTTP, with no simple options for relaying or forwarding the original client TLS certs.  That's why the <code>jobs-framework-api</code> doesn't use the main Toolofrge ingress setup.
</p><p>This results in two types of connections, as shown in the diagram above:
</p>
<ul><li><b>connection type 1</b>: an user contacts <code>jobs-framework-api</code> using k8s client TLS certs from its home directory. The TLS connection is established to the <code>ingress-ngnx-jobs</code>, which has the client-side TLS termination. This can happen from a Toolforge bastion, or from a Job already running inside kubernetes. The connection can be made either using <code>jobs-framework-cli</code> or directly contacting <code>jobs-framework-api</code> programmatically by other methods.</li>
<li><b>connection type 2</b>: once the CommonName of the original request certificate is validated, <code>jobs-framework-api</code> can load the same k8s client TLS certificate from the user home, and <i>supplant</i> the user to contact the k8s API. For this to be possible, the <code>jobs-framework-api</code> component needs permissions for every user home directory, pretty much like <code>maintain-kubeusers</code> has.</li></ul>
<p>This setup is possible because the x509 certificates are maintained by the <code>maintain-kubeusers</code> component, and because <code>jobs-framework-api</code> runs inside the kubernetes cluster itself and therefore can be configured with enough permissions to read each users home.
</p><p>More or other authentication mechanisms can be introduced in the future as we detect new use cases.
</p><p>The Toolforge front proxy exists today basically for webservices running in the grid. Once the grid is fully deprecated and we no longer need the front proxy, we could re-evaluate this whole situation and simplify it.
</p>
<h3><span id="Ingress_.26_TLS"></span><span class="mw-headline" id="Ingress_&amp;_TLS" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-Ingress_&amp;_TLS-The_framework&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:3,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-Ingress_&amp;_TLS-The_framework"></span>Ingress &amp; TLS<span data-mw-comment-end="h-Ingress_&amp;_TLS-The_framework"></span></span></h3>
<p>The <code>jobs-framework-api</code> doesn't use a kubernetes ingress deployment. Instead, it deploys its own nodeport service in the <code>jobs-api</code> namespace.
</p><p>The jobs-specific one is able to read TLS client certificates and pass the <code>ssl-client-subject-dn</code> HTTP header to the pod running the <code>toolforge-jobs-api</code> webservice.
With this information <code>toolforge-jobs-api</code> can load again the client cert when talking to the k8s API on behalf of the original user.
</p><p>The way this whole ingress/TLS setup works is as follows:
</p>
<ul><li>The FQDN <code>jobs.svc.toolsbeta.eqiad1.wikimedia.cloud</code> that points to the k8s haproxy VIP address.</li>
<li>The haproxy system listens on 30001/TCP for this jobs-specific ingress (and in 30000/TCP for the general one).</li>
<li>The haproxy daemon reaches all k8s worker nodes on 30001/TCP, where there is a nodeport service in the <code>jobs-api</code> namespace, that redirects packets to the <code>jobs-api</code> deployment.</li>
<li>The deployment consist on 1 pod with 2 containers: nginx &amp; the <code>jobs-framework-api</code> itself.</li>
<li>The nginx container handles the TLS termination and proxies the API by means of a socket.</li>
<li>Once the TLS certs are verified the proxy injects the HTTP header <code>ssl-client-subject-dn</code> to <code>jobs-framework-api</code>, which contains the <code>CN=</code> information of the original user.</li>
<li>With the <code>ssl-client-subject-dn</code> header, <code>jobs-framework-api</code> can load again the client certificate from the original user home on NFS and in turn contact the k8s API using them.</li></ul>
<h3><span class="mw-headline" id="About_logs" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-About_logs-The_framework&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:3,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-About_logs-The_framework"></span>About logs<span data-mw-comment-end="h-About_logs-The_framework"></span></span></h3>
<p>Logs produced by jobs should not be made available using <code>kubectl logs</code> because that means the stderr/stdout of the pod is being RW in the etcd cluster. If left unattended, logs produced by jobs can easily hammer and bring down our etcd clusters.
</p><p>Logs should be stored in each user NFS home directory, until we come up with some holistic solution at kubernetes level like <a rel="nofollow" class="external free" href="https://kubernetes.io/docs/concepts/cluster-administration/logging/">https://kubernetes.io/docs/concepts/cluster-administration/logging/</a>
</p>
<h3><span class="mw-headline" id="Endpoints" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-Endpoints-The_framework&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:3,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-Endpoints-The_framework"></span>Endpoints<span data-mw-comment-end="h-Endpoints-The_framework"></span></span></h3>
<p>Some relevant URLs:
</p>
<ul><li><a rel="nofollow" class="external free" href="https://jobs.svc.tools.eqiad1.wikimedia.cloud:30001/api/v1">https://jobs.svc.tools.eqiad1.wikimedia.cloud:30001/api/v1</a> --- API endpoint in the <b>tools</b> project.</li>
<li><a rel="nofollow" class="external free" href="https://jobs.svc.toolsbeta.eqiad1.wikimedia.cloud:30001/api/v1">https://jobs.svc.toolsbeta.eqiad1.wikimedia.cloud:30001/api/v1</a> --- API endpoint in the <b>toolsbeta</b> project.</li>
<li><a class="external free" href="https://jobs.toolforge.org/">https://jobs.toolforge.org/</a> --- name-reserved Toolforge tool (<a class="external text" href="https://toolsadmin.wikimedia.org/tools/id/jobs">toolsadmin</a>) (<a class="external text" href="https://toolhub.wikimedia.org/tools/toolforge-jobs">toolhub</a>)</li></ul>
<p>Please note that as of this writing the API endpoints are only available within Toolforge / Cloud VPS (internal IP address, no floating IP).
</p>
<h2><span class="mw-headline" id="Deployment_and_maintenance" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-Deployment_and_maintenance&quot;,&quot;replies&quot;:[&quot;h-jobs-framework-api-Deployment_and_maintenance&quot;,&quot;h-jobs-framework-cli-Deployment_and_maintenance&quot;,&quot;h-jobs-framework-emailer-Deployment_and_maintenance&quot;],&quot;headingLevel&quot;:2,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-Deployment_and_maintenance"></span>Deployment and maintenance<span data-mw-comment-end="h-Deployment_and_maintenance"></span></span></h2>
<p>Information on how to deploy and maintain the framework.
</p>
<h3><span class="mw-headline" id="jobs-framework-api" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-jobs-framework-api-Deployment_and_maintenance&quot;,&quot;replies&quot;:[&quot;h-deployment-jobs-framework-api&quot;,&quot;h-maintenance-jobs-framework-api&quot;],&quot;headingLevel&quot;:3,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-jobs-framework-api-Deployment_and_maintenance"></span>jobs-framework-api<span data-mw-comment-end="h-jobs-framework-api-Deployment_and_maintenance"></span></span></h3>
<h4><span class="mw-headline" id="deployment" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-deployment-jobs-framework-api&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-deployment-jobs-framework-api"></span>deployment<span data-mw-comment-end="h-deployment-jobs-framework-api"></span></span></h4>
<p>The usual workflow to deploy a custom k8s component, which should really be automated, see <a href="https://phabricator.wikimedia.org/T291915" class="extiw" title="phab:T291915"> Phabricator T291915: toolforge: automate how we deploy custom k8s components</a>.
</p>
<h4><span class="mw-headline" id="maintenance" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-maintenance-jobs-framework-api&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-maintenance-jobs-framework-api"></span>maintenance<span data-mw-comment-end="h-maintenance-jobs-framework-api"></span></span></h4>
<p>To see logs, try something like:
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">user@toolsbeta-test-k8s-control-4:~$ </span>sudo -i kubectl logs deployment/jobs-api -n jobs-api nginx
<span class="go">[..]</span>
<span class="go">192.168.17.192 - - [15/Feb/2022:12:57:54 +0000] "GET /api/v1/containers/ HTTP/1.1" 200 2655 "-" "python-requests/2.21.0"</span>
<span class="go">192.168.81.64 - - [15/Feb/2022:12:59:50 +0000] "GET /api/v1/list/ HTTP/1.1" 200 3 "-" "python-requests/2.21.0"</span>
<span class="go">192.168.17.192 - - [15/Feb/2022:13:00:34 +0000] "GET /api/v1/containers/ HTTP/1.1" 200 2655 "-" "python-requests/2.21.0"</span>
<span class="go">192.168.81.64 - - [15/Feb/2022:13:01:01 +0000] "GET /api/v1/containers/ HTTP/1.1" 200 2655 "-" "python-requests/2.21.0"</span>
<span class="go">192.168.17.192 - - [15/Feb/2022:13:01:02 +0000] "POST /api/v1/run/ HTTP/1.1" 409 52 "-" "python-requests/2.21.0"</span>
<span class="gp">user@toolsbeta-test-k8s-control-4:~$ </span>sudo -i kubectl logs deployment/jobs-api -n jobs-api webservice
<span class="go">[..]</span>
<span class="go">*** Operational MODE: single process ***</span>
<span class="go">mounting api:app on /</span>
<span class="go">Adding available container: {'shortname': 'tf-bullseye-std', 'image': 'docker-registry.tools.wmflabs.org/toolforge-bullseye-standalone:latest'}</span>
<span class="go">Adding available container: {'shortname': 'tf-buster-std-DEPRECATED', 'image': 'docker-registry.tools.wmflabs.org/toolforge-buster-standalone:latest'}</span>
<span class="go">Adding available container: {'shortname': 'tf-golang', 'image': 'docker-registry.tools.wmflabs.org/toolforge-golang-sssd-base:latest'}</span>
<span class="go">Adding available container: {'shortname': 'tf-golang111', 'image': 'docker-registry.tools.wmflabs.org/toolforge-golang111-sssd-base:latest'}</span>
<span class="go">Adding available container: {'shortname': 'tf-jdk17', 'image': 'docker-registry.tools.wmflabs.org/toolforge-jdk17-sssd-base:latest'}</span>
<span class="go">[..]</span>
</pre></div>
<p>To verify the API endpoint is up try something like:
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">user@toolsbeta-test-k8s-control-4:~$ </span>curl https://jobs.svc.toolsbeta.eqiad1.wikimedia.cloud:30001/api/v1/list -k
<span class="go">&lt;html></span>
<span class="go">&lt;head>&lt;title>400 No required SSL certificate was sent&lt;/title>&lt;/head></span>
<span class="go">&lt;body></span>
<span class="go">&lt;center>&lt;h1>400 Bad Request&lt;/h1>&lt;/center></span>
<span class="go">&lt;center>No required SSL certificate was sent&lt;/center></span>
<span class="go">&lt;hr>&lt;center>nginx/1.21.0&lt;/center></span>
<span class="go">&lt;/body></span>
<span class="go">&lt;/html></span>
</pre></div>
<p>The 400 error is expected in that example because we're not sending a TLS client certificate, meaning nginx is doing its work correctly.
</p><p>See how many jobs of a given type are defined:
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">user@tools-k8s-control-1:~$ </span>sudo -i kubectl get <span class="nb">jobs</span> -A -l app.kubernetes.io/managed-by<span class="o">=</span>toolforge-jobs-framework -l app.kubernetes.io/component<span class="o">=</span><span class="nb">jobs</span>
<span class="go">No resources found      &lt;-- this is somewhat normal, jobs may be short-lived</span>
<span class="gp">user@tools-k8s-control-1:~$ </span>sudo -i kubectl get cronjob -A -l app.kubernetes.io/managed-by<span class="o">=</span>toolforge-jobs-framework -l app.kubernetes.io/component<span class="o">=</span>cronjobs
<span class="go">NAMESPACE                NAME                              SCHEDULE           SUSPEND   ACTIVE   LAST SCHEDULE   AGE</span>
<span class="go">tool-admin               updatetools                       19,39,59 * * * *   False     0        3m57s           31d</span>
<span class="go">tool-botriconferme       botriconferme-full                0,10 22,23 * * *   False     0        16h             27h</span>
<span class="go">tool-botriconferme       botriconferme-purge-log           0 0 1 * *          False     0        &lt;none>          27h</span>
<span class="go">tool-botriconferme       botriconferme-quick               */15 * * * *       False     0        2m57s           27h</span>
<span class="go">tool-cdnjs               update-index                      17 4 * * *         False     1        12d             34d</span>
<span class="go">[..]</span>
<span class="gp">user@tools-k8s-control-1:~$ </span>sudo -i kubectl get deploy -A -l app.kubernetes.io/managed-by<span class="o">=</span>toolforge-jobs-framework -l app.kubernetes.io/component<span class="o">=</span>deployments
<span class="go">NAMESPACE              NAME                          READY   UP-TO-DATE   AVAILABLE   AGE</span>
<span class="go">tool-cluebot3          cluebot3                      1/1     1            1           10d</span>
<span class="go">tool-fixsuggesterbot   fix-suggester-bot-consume     1/1     1            1           198d</span>
<span class="go">tool-fixsuggesterbot   fix-suggester-bot-subscribe   1/1     1            1           198d</span>
<span class="go">tool-majavah-bot       t1-enwiki                     1/1     1            1           18d</span>
<span class="go">tool-mjolnir           mjolnir                       1/1     1            1           186d</span>
<span class="go">tool-mjolnir           uatu                          1/1     1            1           183d</span>
<span class="go">[..]</span>
</pre></div>
<h3><span class="mw-headline" id="jobs-framework-cli" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-jobs-framework-cli-Deployment_and_maintenance&quot;,&quot;replies&quot;:[&quot;h-deployment_2-jobs-framework-cli&quot;],&quot;headingLevel&quot;:3,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-jobs-framework-cli-Deployment_and_maintenance"></span>jobs-framework-cli<span data-mw-comment-end="h-jobs-framework-cli-Deployment_and_maintenance"></span></span></h3>
<h4><span class="mw-headline" id="deployment_2" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-deployment_2-jobs-framework-cli&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-deployment_2-jobs-framework-cli"></span>deployment<span data-mw-comment-end="h-deployment_2-jobs-framework-cli"></span></span></h4>
<p>A simple debian package installed on the bastions. See <a href="/wiki/Portal:Toolforge/Admin/Packaging" title="Portal:Toolforge/Admin/Packaging">Portal:Toolforge/Admin/Packaging</a>.
</p>
<h3><span class="mw-headline" id="jobs-framework-emailer" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-jobs-framework-emailer-Deployment_and_maintenance&quot;,&quot;replies&quot;:[&quot;h-deployment_3-jobs-framework-emailer&quot;,&quot;h-maintenance_2-jobs-framework-emailer&quot;],&quot;headingLevel&quot;:3,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-jobs-framework-emailer-Deployment_and_maintenance"></span>jobs-framework-emailer<span data-mw-comment-end="h-jobs-framework-emailer-Deployment_and_maintenance"></span></span></h3>
<h4><span class="mw-headline" id="deployment_3" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-deployment_3-jobs-framework-emailer&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-deployment_3-jobs-framework-emailer"></span>deployment<span data-mw-comment-end="h-deployment_3-jobs-framework-emailer"></span></span></h4>
<p>The usual workflow to deploy a custom k8s component, which should really be automated, see <a href="https://phabricator.wikimedia.org/T291915" class="extiw" title="phab:T291915"> Phabricator T291915: toolforge: automate how we deploy custom k8s components</a>.
</p>
<h4><span class="mw-headline" id="maintenance_2" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-maintenance_2-jobs-framework-emailer&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-maintenance_2-jobs-framework-emailer"></span>maintenance<span data-mw-comment-end="h-maintenance_2-jobs-framework-emailer"></span></span></h4>
<p>Service logs:
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">user@tools-k8s-control-1:~$ </span>sudo -i kubectl -n jobs-emailer logs deployment/jobs-emailer
</pre></div>
<p>Live configuration can be seen with:
</p>
<div class="mw-highlight mw-highlight-lang-shell-session mw-content-ltr" dir="ltr"><pre><span></span><span class="gp">user@tools-k8s-control-1:~$ </span>sudo -i kubectl -n jobs-emailer get cm jobs-emailer-configmap -o yaml
<span class="go">apiVersion: v1</span>
<span class="go">kind: ConfigMap</span>
<span class="go">metadata:</span>
<span class="go">  [..]</span>
<span class="go">data:</span>
<span class="go">  debug: "yes"</span>
<span class="go">  email_from_addr: noreply@toolforge.org</span>
<span class="go">  email_to_domain: tools.wmflabs.org</span>
<span class="go">  email_to_prefix: tools</span>
<span class="go">  send_emails_for_real: "yes"</span>
<span class="go">  smtp_server_fqdn: mail.tools.wmflabs.org</span>
<span class="go">  smtp_server_port: "25"</span>
<span class="go">  task_compose_emails_loop_sleep: "400"</span>
<span class="go">  task_read_configmap_sleep: "10"</span>
<span class="go">  task_send_emails_loop_sleep: "10"</span>
<span class="go">  task_send_emails_max: "10"</span>
<span class="go">  task_watch_pods_timeout: "60"</span>
</pre></div>
<p>Values can be edited with <code>kubectl -n jobs-emailer edit cm jobs-emailer-configmap</code>. Editing some value will trigger a live reconfiguration (no need to restart anything).
</p>
<h2><span class="mw-headline" id="API_docs" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-API_docs&quot;,&quot;replies&quot;:[&quot;h-POST_\/api\/v1\/run\/-API_docs&quot;,&quot;h-GET_\/api\/v1\/show\/{name}\/-API_docs&quot;,&quot;h-DELETE_\/api\/v1\/delete\/{name}-API_docs&quot;,&quot;h-GET_\/api\/v1\/list\/-API_docs&quot;,&quot;h-DELETE_\/api\/v1\/flush\/-API_docs&quot;,&quot;h-GET_\/api\/v1\/containers\/-API_docs&quot;],&quot;headingLevel&quot;:2,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-API_docs"></span>API docs<span data-mw-comment-end="h-API_docs"></span></span></h2>
<p>This section contains concrete details for the API that TJF introduces.
</p><p><b>TODO:</b> this is outdated, we need swagger or similar to keep this up-to-date.
</p>
<h4><span id="POST_.2Fapi.2Fv1.2Frun.2F"></span><span class="mw-headline" id="POST_/api/v1/run/" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-POST_\/api\/v1\/run\/-API_docs&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-POST_/api/v1/run/-API_docs"></span>POST /api/v1/run/<span data-mw-comment-end="h-POST_/api/v1/run/-API_docs"></span></span></h4>
<p>Creates a new job in the kubernetes cluster.
</p>
<table class="navbox mw-collapsible mw-collapsed" style="text-align: left; border: 1px solid silver; margin-top: 0.2em;">

<tbody><tr>
<th style="background-color: #CFC;">POST /api/v1/run/ details
</th></tr>
<tr>
<td style="text-align:center;"><i>The following content has been placed in a collapsed box for improved usability.</i>
</td></tr>
<tr>
<td style="border: solid 1px silver; padding: 8px; background-color: white;">
<p><br/>
</p>
<table class="wikitable sortable">
<caption>Request parameters
</caption>
<tbody><tr>
<th>name</th>
<th>datatype</th>
<th>required</th>
<th>comment
</th></tr>
<tr>
<td>name</td>
<td>string</td>
<td>yes</td>
<td>Name identification for the new job
</td></tr>
<tr>
<td>cmd</td>
<td>string</td>
<td>yes</td>
<td>Job command line to execute, including arguments
</td></tr>
<tr>
<td>type</td>
<td>string</td>
<td>yes</td>
<td>Job container type
</td></tr>
<tr>
<td>schedule</td>
<td>string</td>
<td>optional</td>
<td>If present, job will be scheduled. String is cron syntax, like <code>*/1 * * * *</code>. Mutually exclusive with <code>continuous</code>.
</td></tr>
<tr>
<td>continuous</td>
<td>boolean</td>
<td>optional</td>
<td>If <code>true</code>, job will be persistent. Mutually exclusive with <code>schedule</code>.
</td></tr></tbody></table>
<p>Example request data:
</p>
<div class="mw-highlight mw-highlight-lang-json mw-content-ltr" dir="ltr"><pre><span></span><span class="p">{</span>
  <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"myjob"</span><span class="p">,</span>
  <span class="nt">"cmd"</span><span class="p">:</span> <span class="s2">"./myscript.py --once"</span><span class="p">,</span>
  <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"toolforge-buster-sssd"</span><span class="p">,</span>
  <span class="nt">"schedule"</span><span class="p">:</span> <span class="s2">"*/1 * * * *"</span>
<span class="p">}</span>
</pre></div>
</td></tr>
<tr>
<td style="text-align:center;"><i>The above content has been placed in a collapsed box for improved usability.</i>
</td></tr></tbody></table>
<h4><span id="GET_.2Fapi.2Fv1.2Fshow.2F.7Bname.7D.2F"></span><span class="mw-headline" id="GET_/api/v1/show/{name}/" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-GET_\/api\/v1\/show\/{name}\/-API_docs&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-GET_/api/v1/show/{name}/-API_docs"></span>GET /api/v1/show/{name}/<span data-mw-comment-end="h-GET_/api/v1/show/{name}/-API_docs"></span></span></h4>
<p>Shows information about a job in the kubernetes cluster.
</p>
<table class="navbox mw-collapsible mw-collapsed" style="text-align: left; border: 1px solid silver; margin-top: 0.2em;">

<tbody><tr>
<th style="background-color: #CFC;">GET /api/v1/show/{name}/ details
</th></tr>
<tr>
<td style="text-align:center;"><i>The following content has been placed in a collapsed box for improved usability.</i>
</td></tr>
<tr>
<td style="border: solid 1px silver; padding: 8px; background-color: white;">
<p><br/>
</p>
<table class="wikitable sortable">
<caption>Request parameters
</caption>
<tbody><tr>
<th>name</th>
<th>datatype</th>
<th>required</th>
<th>comment
</th></tr>
<tr>
<td>name</td>
<td>string</td>
<td>yes</td>
<td>Job name identification
</td></tr></tbody></table>
<table class="wikitable sortable">
<caption>Response parameters
</caption>
<tbody><tr>
<th>name</th>
<th>datatype</th>
<th>comment
</th></tr>
<tr>
<td>name</td>
<td>string</td>
<td>Job name identification
</td></tr>
<tr>
<td>cmd</td>
<td>string</td>
<td>Job command line, including arguments
</td></tr>
<tr>
<td>type</td>
<td>string</td>
<td>Job container type
</td></tr>
<tr>
<td>schedule</td>
<td>string</td>
<td>Job schedule string in cron syntax, like <code>*/1 * * * *</code>
</td></tr>
<tr>
<td>continuous</td>
<td>boolean</td>
<td>True if job is persistent
</td></tr>
<tr>
<td>state</td>
<td>string</td>
<td>Job current state
</td></tr></tbody></table>
<p>Example response JSON data:
</p>
<div class="mw-highlight mw-highlight-lang-json mw-content-ltr" dir="ltr"><pre><span></span><span class="p">{</span>
  <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"myjob"</span><span class="p">,</span>
  <span class="nt">"cmd"</span><span class="p">:</span> <span class="s2">"./myscript.py --once"</span><span class="p">,</span>
  <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"python"</span><span class="p">,</span>
  <span class="nt">"continuous"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
  <span class="s2">"state"</span><span class="err">;</span> <span class="s2">"finished"</span>
<span class="p">}</span>
</pre></div>
</td></tr>
<tr>
<td style="text-align:center;"><i>The above content has been placed in a collapsed box for improved usability.</i>
</td></tr></tbody></table>
<h4><span id="DELETE_.2Fapi.2Fv1.2Fdelete.2F.7Bname.7D"></span><span class="mw-headline" id="DELETE_/api/v1/delete/{name}" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-DELETE_\/api\/v1\/delete\/{name}-API_docs&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-DELETE_/api/v1/delete/{name}-API_docs"></span>DELETE /api/v1/delete/{name}<span data-mw-comment-end="h-DELETE_/api/v1/delete/{name}-API_docs"></span></span></h4>
<p>Delete a job in the kubernetes cluster.
</p>
<table class="navbox mw-collapsible mw-collapsed" style="text-align: left; border: 1px solid silver; margin-top: 0.2em;">

<tbody><tr>
<th style="background-color: #CFC;">DELETE /api/v1/delete/{name} details
</th></tr>
<tr>
<td style="text-align:center;"><i>The following content has been placed in a collapsed box for improved usability.</i>
</td></tr>
<tr>
<td style="border: solid 1px silver; padding: 8px; background-color: white;">
<table class="wikitable sortable">
<caption>Request parameters
</caption>
<tbody><tr>
<th>name</th>
<th>datatype</th>
<th>required</th>
<th>comment
</th></tr>
<tr>
<td>name</td>
<td>string</td>
<td>yes</td>
<td>Job name identification
</td></tr></tbody></table>
</td></tr>
<tr>
<td style="text-align:center;"><i>The above content has been placed in a collapsed box for improved usability.</i>
</td></tr></tbody></table>
<h4><span id="GET_.2Fapi.2Fv1.2Flist.2F"></span><span class="mw-headline" id="GET_/api/v1/list/" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-GET_\/api\/v1\/list\/-API_docs&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-GET_/api/v1/list/-API_docs"></span>GET /api/v1/list/<span data-mw-comment-end="h-GET_/api/v1/list/-API_docs"></span></span></h4>
<p>Shows information about all user jobs in the kubernetes cluster.
</p>
<table class="navbox mw-collapsible mw-collapsed" style="text-align: left; border: 1px solid silver; margin-top: 0.2em;">

<tbody><tr>
<th style="background-color: #CFC;">GET /api/v1/list/ details
</th></tr>
<tr>
<td style="text-align:center;"><i>The following content has been placed in a collapsed box for improved usability.</i>
</td></tr>
<tr>
<td style="border: solid 1px silver; padding: 8px; background-color: white;">
<p><br/>
There are no request parameters.
</p>
<table class="wikitable sortable">
<caption>Response parameters (list)
</caption>
<tbody><tr>
<th>name</th>
<th>datatype</th>
<th>comment
</th></tr>
<tr>
<td>name</td>
<td>string</td>
<td>Job name identification
</td></tr>
<tr>
<td>cmd</td>
<td>string</td>
<td>Job command line, including arguments
</td></tr>
<tr>
<td>type</td>
<td>string</td>
<td>Job container type
</td></tr>
<tr>
<td>schedule</td>
<td>string</td>
<td>Job schedule string in cron syntax, like <code>*/1 * * * *</code>
</td></tr>
<tr>
<td>continuous</td>
<td>boolean</td>
<td>True if job is persistent
</td></tr>
<tr>
<td>state</td>
<td>string</td>
<td>Job current state
</td></tr></tbody></table>
<p>Example response JSON data:
</p>
<div class="mw-highlight mw-highlight-lang-json mw-content-ltr" dir="ltr"><pre><span></span><span class="p">[</span>
  <span class="p">{</span>
    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"myjob"</span><span class="p">,</span>
    <span class="nt">"cmd"</span><span class="p">:</span> <span class="s2">"./myscript.py --once"</span><span class="p">,</span>
    <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"toolforge-buster-sssd"</span><span class="p">,</span>
    <span class="nt">"continuous"</span><span class="p">:</span> <span class="kc">false</span><span class="p">,</span>
    <span class="nt">"state"</span><span class="p">:</span> <span class="s2">"finished"</span>
  <span class="p">},</span>
  <span class="p">{</span>
    <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"myotherjob"</span><span class="p">,</span>
    <span class="nt">"cmd"</span><span class="p">:</span> <span class="s2">"./myotherscript.py --once"</span><span class="p">,</span>
    <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"toolforge-buster-sssd"</span><span class="p">,</span>
    <span class="nt">"schedule"</span><span class="p">:</span> <span class="s2">"*/1 * * * *"</span><span class="p">,</span>
    <span class="nt">"state"</span><span class="p">:</span> <span class="s2">"running"</span>
  <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</td></tr>
<tr>
<td style="text-align:center;"><i>The above content has been placed in a collapsed box for improved usability.</i>
</td></tr></tbody></table>
<h4><span id="DELETE_.2Fapi.2Fv1.2Fflush.2F"></span><span class="mw-headline" id="DELETE_/api/v1/flush/" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-DELETE_\/api\/v1\/flush\/-API_docs&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-DELETE_/api/v1/flush/-API_docs"></span>DELETE /api/v1/flush/<span data-mw-comment-end="h-DELETE_/api/v1/flush/-API_docs"></span></span></h4>
<p>Delete all user jobs in the kubernetes cluster.
</p>
<table class="navbox mw-collapsible mw-collapsed" style="text-align: left; border: 1px solid silver; margin-top: 0.2em;">

<tbody><tr>
<th style="background-color: #CFC;">DELETE /api/v1/flush/ details
</th></tr>
<tr>
<td style="text-align:center;"><i>The following content has been placed in a collapsed box for improved usability.</i>
</td></tr>
<tr>
<td style="border: solid 1px silver; padding: 8px; background-color: white;">
<p>There are no request parameters.
</p>
</td></tr>
<tr>
<td style="text-align:center;"><i>The above content has been placed in a collapsed box for improved usability.</i>
</td></tr></tbody></table>
<h4><span id="GET_.2Fapi.2Fv1.2Fcontainers.2F"></span><span class="mw-headline" id="GET_/api/v1/containers/" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-GET_\/api\/v1\/containers\/-API_docs&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:4,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-GET_/api/v1/containers/-API_docs"></span>GET /api/v1/containers/<span data-mw-comment-end="h-GET_/api/v1/containers/-API_docs"></span></span></h4>
<p>Shows information about all containers available for jobs in the kubernetes cluster.
</p>
<table class="navbox mw-collapsible mw-collapsed" style="text-align: left; border: 1px solid silver; margin-top: 0.2em;">

<tbody><tr>
<th style="background-color: #CFC;">GET /api/v1/containers/ details
</th></tr>
<tr>
<td style="text-align:center;"><i>The following content has been placed in a collapsed box for improved usability.</i>
</td></tr>
<tr>
<td style="border: solid 1px silver; padding: 8px; background-color: white;">
<p><br/>
There are no request parameters.
</p>
<table class="wikitable sortable">
<caption>Response parameters (list)
</caption>
<tbody><tr>
<th>name</th>
<th>datatype</th>
<th>comment
</th></tr>
<tr>
<td>name</td>
<td>string</td>
<td>container shortname
</td></tr>
<tr>
<td>type</td>
<td>string</td>
<td>container URL
</td></tr></tbody></table>
<p>Example response JSON data:
</p>
<div class="mw-highlight mw-highlight-lang-json mw-content-ltr" dir="ltr"><pre><span></span><span class="p">[</span>
    <span class="p">{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"tf-buster"</span><span class="p">,</span>
        <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"docker-registry.tools.wmflabs.org/toolforge-buster-sssd:latest"</span>
    <span class="p">},</span>
    <span class="p">{</span>
        <span class="nt">"name"</span><span class="p">:</span> <span class="s2">"tf-buster-std"</span><span class="p">,</span>
        <span class="nt">"type"</span><span class="p">:</span> <span class="s2">"docker-registry.tools.wmflabs.org/toolforge-buster-standalone:latest"</span>
    <span class="p">}</span>
<span class="p">]</span>
</pre></div>
</td></tr>
<tr>
<td style="text-align:center;"><i>The above content has been placed in a collapsed box for improved usability.</i>
</td></tr></tbody></table>
<p><br/>
</p>
<h2><span class="mw-headline" id="See_also" data-mw-comment="{&quot;type&quot;:&quot;heading&quot;,&quot;level&quot;:0,&quot;id&quot;:&quot;h-See_also&quot;,&quot;replies&quot;:[],&quot;headingLevel&quot;:2,&quot;placeholderHeading&quot;:false,&quot;name&quot;:&quot;h-&quot;}"><span data-mw-comment-start="" id="h-See_also"></span>See also<span data-mw-comment-end="h-See_also"></span></span></h2>
<ul><li><a href="/wiki/Wikimedia_Cloud_Services_team/EnhancementProposals/Toolforge_jobs" title="Wikimedia Cloud Services team/EnhancementProposals/Toolforge jobs">Wikimedia_Cloud_Services_team/EnhancementProposals/Toolforge_jobs</a> -- where this was initially designed.</li>
<li><a href="/wiki/Help:Toolforge/Jobs_framework" title="Help:Toolforge/Jobs framework">Help:Toolforge/Jobs_framework</a> -- end user documentation</li>
<li><a href="https://phabricator.wikimedia.org/T286135" class="extiw" title="phab:T286135"> Phabricator T286135: Toolforge jobs framework: email maintainers on job failure</a> -- original feature request for the emailer component.</li></ul>
<p>Some upstream kubernetes documentation pointers:
</p>
<ul><li><a rel="nofollow" class="external free" href="https://kubernetes.io/docs/concepts/workloads/controllers/job/">https://kubernetes.io/docs/concepts/workloads/controllers/job/</a></li>
<li><a rel="nofollow" class="external free" href="https://kubernetes.io/docs/concepts/workloads/controllers/replicationcontroller/">https://kubernetes.io/docs/concepts/workloads/controllers/replicationcontroller/</a></li>
<li><a rel="nofollow" class="external free" href="https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/">https://kubernetes.io/docs/concepts/workloads/pods/pod-lifecycle/</a></li>
<li><a rel="nofollow" class="external free" href="https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/">https://kubernetes.io/docs/concepts/workloads/controllers/cron-jobs/</a></li>
<li><a rel="nofollow" class="external free" href="https://kubernetes.io/docs/tasks/job/">https://kubernetes.io/docs/tasks/job/</a></li>
<li><a rel="nofollow" class="external free" href="https://kubernetes.io/docs/tasks/job/automated-tasks-with-cron-jobs/">https://kubernetes.io/docs/tasks/job/automated-tasks-with-cron-jobs/</a></li>
<li><a rel="nofollow" class="external free" href="https://kubernetes.io/docs/concepts/workloads/controllers/job/#ttl-mechanism-for-finished-jobs">https://kubernetes.io/docs/concepts/workloads/controllers/job/#ttl-mechanism-for-finished-jobs</a></li></ul>
<p>Related components:
</p>
<ul><li><a class="external text" href="https://gerrit.wikimedia.org/g/operations/software/tools-webservice/+/refs/heads/master">operations/software/tools-webservice.git</a></li></ul>
<!-- 
NewPP limit report
Parsed by labweb1002
Cached time: 20220420191639
Cache expiry: 1814400
Reduced expiry: false
Complications: []
DiscussionTools time usage: 0.030 seconds
CPU time usage: 0.119 seconds
Real time usage: 0.144 seconds
Preprocessor visited node count: 509/1000000
Postexpand include size: 3922/2097152 bytes
Template argument size: 272/2097152 bytes
Highest expansion depth: 12/100
Expensive parser function count: 0/500
Unstrip recursion depth: 0/20
Unstrip postexpand size: 12519/5000000 bytes
Lua time usage: 0.007/10.000 seconds
Lua memory usage: 521376/52428800 bytes
-->
<!--
Transclusion expansion time report (%,ms,calls,template)
100.00%   62.329      1 -total
 64.04%   39.918      1 Template:Tracked
 58.06%   36.189      3 Template:Dir
 48.80%   30.418      3 Template:Pagelang
 11.62%    7.245      6 Template:Collapse_top
  4.45%    2.775      6 Template:Collapse_bottom
-->

<!-- Saved in parser cache with key labswiki:pcache:idhash:448850-0!canonical and timestamp 20220420191639 and revision id 1959213. Serialized with JSON.
 -->
</div>
<div class="printfooter">Retrieved from "<a dir="ltr" href="https://wikitech.wikimedia.org/w/index.php?title=Portal:Toolforge/Admin/Kubernetes/jobs&amp;oldid=1959213">https://wikitech.wikimedia.org/w/index.php?title=Portal:Toolforge/Admin/Kubernetes/jobs&amp;oldid=1959213</a>"</div></div>
		<div id="catlinks" class="catlinks catlinks-allhidden" data-mw="interface"></div>
	</div>
</div>

<div id="mw-navigation">
	<h2>Navigation menu</h2>
	<div id="mw-head">
		
<nav id="p-personal" class="mw-portlet mw-portlet-personal vector-user-menu-legacy vector-menu" aria-labelledby="p-personal-label" role="navigation" 
	 >
	<label id="p-personal-label" aria-label="" class="vector-menu-heading "  >
		<span class="vector-menu-heading-label">Personal tools</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="pt-uls" class="mw-list-item active"><a class="uls-trigger" href="#"><span>English</span></a></li><li id="pt-createaccount" class="mw-list-item"><a href="/w/index.php?title=Special:CreateAccount&amp;returnto=Portal%3AToolforge%2FAdmin%2FKubernetes%2Fjobs" title="You are encouraged to create an account and log in; however, it is not mandatory"><span>Create account</span></a></li><li id="pt-login" class="mw-list-item"><a href="/w/index.php?title=Special:UserLogin&amp;returnto=Portal%3AToolforge%2FAdmin%2FKubernetes%2Fjobs" title="You are encouraged to log in; however, it is not mandatory [o]" accesskey="o"><span>Log in</span></a></li></ul>
		
	</div>
</nav>

		<div id="left-navigation">
			
<nav id="p-namespaces" class="mw-portlet mw-portlet-namespaces vector-menu vector-menu-tabs" aria-labelledby="p-namespaces-label" role="navigation" 
	 >
	<label id="p-namespaces-label" aria-label="" class="vector-menu-heading "  >
		<span class="vector-menu-heading-label">Namespaces</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-nstab-main" class="selected mw-list-item"><a href="/wiki/Portal:Toolforge/Admin/Kubernetes/jobs" title="View the content page [c]" accesskey="c"><span>Page</span></a></li><li id="ca-talk" class="new mw-list-item"><a href="/w/index.php?title=Talk:Portal:Toolforge/Admin/Kubernetes/jobs&amp;action=edit&amp;redlink=1" rel="discussion" title="Discussion about the content page (page does not exist) [t]" accesskey="t"><span>Discussion</span></a></li></ul>
		
	</div>
</nav>

			
<nav id="p-variants" class="mw-portlet mw-portlet-variants emptyPortlet vector-menu-dropdown-noicon vector-menu vector-menu-dropdown" aria-labelledby="p-variants-label" role="navigation" 
	 >
	<input type="checkbox"
		id="p-variants-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-variants"
		class="vector-menu-checkbox" aria-labelledby="p-variants-label" />
	<label id="p-variants-label" aria-label="Change language variant" class="vector-menu-heading "  >
		<span class="vector-menu-heading-label">English</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

		</div>
		<div id="right-navigation">
			
<nav id="p-views" class="mw-portlet mw-portlet-views vector-menu vector-menu-tabs" aria-labelledby="p-views-label" role="navigation" 
	 >
	<label id="p-views-label" aria-label="" class="vector-menu-heading "  >
		<span class="vector-menu-heading-label">Views</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="ca-view" class="selected mw-list-item"><a href="/wiki/Portal:Toolforge/Admin/Kubernetes/jobs"><span>Read</span></a></li><li id="ca-viewsource" class="mw-list-item"><a href="/w/index.php?title=Portal:Toolforge/Admin/Kubernetes/jobs&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e"><span>View source</span></a></li><li id="ca-history" class="mw-list-item"><a href="/w/index.php?title=Portal:Toolforge/Admin/Kubernetes/jobs&amp;action=history" title="Past revisions of this page [h]" accesskey="h"><span>View history</span></a></li></ul>
		
	</div>
</nav>

			
<nav id="p-cactions" class="mw-portlet mw-portlet-cactions emptyPortlet vector-menu-dropdown-noicon vector-menu vector-menu-dropdown" aria-labelledby="p-cactions-label" role="navigation"  title="More options"
	 >
	<input type="checkbox"
		id="p-cactions-checkbox"
		role="button"
		aria-haspopup="true"
		data-event-name="ui.dropdown-p-cactions"
		class="vector-menu-checkbox" aria-labelledby="p-cactions-label" />
	<label id="p-cactions-label" aria-label="" class="vector-menu-heading "  >
		<span class="vector-menu-heading-label">More</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"></ul>
		
	</div>
</nav>

			
<div id="p-search" role="search" class="vector-search-box-vue  vector-search-box-show-thumbnail vector-search-box-auto-expand-width vector-search-box">
	<div>
			<h3 >
				<label for="searchInput">Search</label>
			</h3>
		<form action="/w/index.php" id="searchform"
			class="vector-search-box-form">
			<div id="simpleSearch"
				class="vector-search-box-inner"
				 data-search-loc="header-navigation">
				<input class="vector-search-box-input"
					 type="search" name="search" placeholder="Search Wikitech" aria-label="Search Wikitech" autocapitalize="sentences" title="Search Wikitech [f]" accesskey="f" id="searchInput"
				/>
				<input type="hidden" name="title" value="Special:Search"/>
				<input id="mw-searchButton"
					 class="searchButton mw-fallbackSearchButton" type="submit" name="fulltext" title="Search the pages for this text" value="Search" />
				<input id="searchButton"
					 class="searchButton" type="submit" name="go" title="Go to a page with this exact name if it exists" value="Go" />
			</div>
		</form>
	</div>
</div>

		</div>
	</div>
	

<div id="mw-panel">
	<div id="p-logo" role="banner">
		<a class="mw-wiki-logo" href="/wiki/Main_Page"
			title="Visit the main page"></a>
	</div>
	
<nav id="p-navigation" class="mw-portlet mw-portlet-navigation vector-menu vector-menu-portal portal" aria-labelledby="p-navigation-label" role="navigation" 
	 >
	<label id="p-navigation-label" aria-label="" class="vector-menu-heading "  >
		<span class="vector-menu-heading-label">Navigation</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-mainpage-description" class="mw-list-item"><a href="/wiki/Main_Page" icon="home" title="Visit the main page [z]" accesskey="z"><span>Main page</span></a></li><li id="n-recentchanges" class="mw-list-item"><a href="/wiki/Special:RecentChanges" icon="recentChanges" title="A list of recent changes in the wiki [r]" accesskey="r"><span>Recent changes</span></a></li><li id="n-Server-admin-log:-Prod" class="mw-list-item"><a href="/wiki/Server_Admin_Log"><span>Server admin log: Prod</span></a></li><li id="n-Admin-log:-RelEng" class="mw-list-item"><a href="/wiki/Release_Engineering/SAL"><span>Admin log: RelEng</span></a></li><li id="n-Incident-status" class="mw-list-item"><a href="/wiki/Incident_status"><span>Incident status</span></a></li><li id="n-Deployments" class="mw-list-item"><a href="/wiki/Deployments"><span>Deployments</span></a></li><li id="n-SRE/Operations-Help" class="mw-list-item"><a href="/wiki/SRE_Team_requests"><span>SRE/Operations Help</span></a></li></ul>
		
	</div>
</nav>

	
<nav id="p-Cloud_VPS_&amp;_Toolforge" class="mw-portlet mw-portlet-Cloud_VPS_Toolforge vector-menu vector-menu-portal portal" aria-labelledby="p-Cloud_VPS_&amp;_Toolforge-label" role="navigation" 
	 >
	<label id="p-Cloud_VPS_&amp;_Toolforge-label" aria-label="" class="vector-menu-heading "  >
		<span class="vector-menu-heading-label">Cloud VPS &amp; Toolforge</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="n-Cloud-VPS-portal" class="mw-list-item"><a href="/wiki/Portal:Cloud_VPS"><span>Cloud VPS portal</span></a></li><li id="n-Toolforge-portal" class="mw-list-item"><a href="/wiki/Portal:Toolforge"><span>Toolforge portal</span></a></li><li id="n-Request-VPS-project" class="mw-list-item"><a href="https://phabricator.wikimedia.org/project/view/2875/"><span>Request VPS project</span></a></li><li id="n-Admin-log:-Cloud-VPS" class="mw-list-item"><a href="/wiki/Cloud_VPS_Server_Admin_Log"><span>Admin log: Cloud VPS</span></a></li></ul>
		
	</div>
</nav>

<nav id="p-tb" class="mw-portlet mw-portlet-tb vector-menu vector-menu-portal portal" aria-labelledby="p-tb-label" role="navigation" 
	 >
	<label id="p-tb-label" aria-label="" class="vector-menu-heading "  >
		<span class="vector-menu-heading-label">Tools</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="t-whatlinkshere" class="mw-list-item"><a href="/wiki/Special:WhatLinksHere/Portal:Toolforge/Admin/Kubernetes/jobs" title="A list of all wiki pages that link here [j]" accesskey="j"><span>What links here</span></a></li><li id="t-recentchangeslinked" class="mw-list-item"><a href="/wiki/Special:RecentChangesLinked/Portal:Toolforge/Admin/Kubernetes/jobs" rel="nofollow" title="Recent changes in pages linked from this page [k]" accesskey="k"><span>Related changes</span></a></li><li id="t-specialpages" class="mw-list-item"><a href="/wiki/Special:SpecialPages" title="A list of all special pages [q]" accesskey="q"><span>Special pages</span></a></li><li id="t-permalink" class="mw-list-item"><a href="/w/index.php?title=Portal:Toolforge/Admin/Kubernetes/jobs&amp;oldid=1959213" title="Permanent link to this revision of the page"><span>Permanent link</span></a></li><li id="t-info" class="mw-list-item"><a href="/w/index.php?title=Portal:Toolforge/Admin/Kubernetes/jobs&amp;action=info" title="More information about this page"><span>Page information</span></a></li><li id="t-cite" class="mw-list-item"><a href="/w/index.php?title=Special:CiteThisPage&amp;page=Portal%3AToolforge%2FAdmin%2FKubernetes%2Fjobs&amp;id=1959213&amp;wpFormIdentifier=titleform" title="Information on how to cite this page"><span>Cite this page</span></a></li></ul>
		
	</div>
</nav>

<nav id="p-coll-print_export" class="mw-portlet mw-portlet-coll-print_export vector-menu vector-menu-portal portal" aria-labelledby="p-coll-print_export-label" role="navigation" 
	 >
	<label id="p-coll-print_export-label" aria-label="" class="vector-menu-heading "  >
		<span class="vector-menu-heading-label">Print/export</span>
	</label>
	<div class="vector-menu-content">
		
		<ul class="vector-menu-content-list"><li id="coll-create_a_book" class="mw-list-item"><a href="/w/index.php?title=Special:Book&amp;bookcmd=book_creator&amp;referer=Portal%3AToolforge%2FAdmin%2FKubernetes%2Fjobs"><span>Create a book</span></a></li><li id="coll-download-as-rl" class="mw-list-item"><a href="/w/index.php?title=Special:DownloadAsPdf&amp;page=Portal%3AToolforge%2FAdmin%2FKubernetes%2Fjobs&amp;action=show-download-screen"><span>Download as PDF</span></a></li><li id="t-print" class="mw-list-item"><a href="/w/index.php?title=Portal:Toolforge/Admin/Kubernetes/jobs&amp;printable=yes" title="Printable version of this page [p]" accesskey="p"><span>Printable version</span></a></li></ul>
		
	</div>
</nav>

	
</div>

</div>

<footer id="footer" class="mw-footer" role="contentinfo" >
	<ul id="footer-info">
	<li id="footer-info-lastmod"> This page was last edited on 23 March 2022, at 16:05.</li>
	<li id="footer-info-copyright">Text is available under the <a href="https://creativecommons.org/licenses/by-sa/3.0/">Creative Commons Attribution-ShareAlike License</a>;
additional terms may apply.
See <a href="https://foundation.wikimedia.org/wiki/Terms_of_Use">Terms of Use</a> for details.</li>
</ul>

	<ul id="footer-places">
	<li id="footer-places-privacy"><a href="https://foundation.wikimedia.org/wiki/Privacy_policy" class="extiw" title="wmf:Privacy policy">Privacy policy</a></li>
	<li id="footer-places-about"><a href="/wiki/Main_Page" title="Main Page">About Wikitech</a></li>
	<li id="footer-places-disclaimer"><a href="https://foundation.wikimedia.org/wiki/General_disclaimer" class="extiw" title="wikimedia:General disclaimer">Disclaimers</a></li>
	<li id="footer-places-wm-codeofconduct"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/Code_of_Conduct">Code of Conduct</a></li>
	<li id="footer-places-mobileview"><a href="//wikitech.wikimedia.org/w/index.php?title=Portal:Toolforge/Admin/Kubernetes/jobs&amp;mobileaction=toggle_view_mobile" class="noprint stopMobileRedirectToggle">Mobile view</a></li>
	<li id="footer-places-developers"><a href="https://www.mediawiki.org/wiki/Special:MyLanguage/How_to_contribute">Developers</a></li>
	<li id="footer-places-statslink"><a href="https://stats.wikimedia.org/#/wikitech.wikimedia.org">Statistics</a></li>
	<li id="footer-places-cookiestatement"><a href="https://foundation.wikimedia.org/wiki/Cookie_statement">Cookie statement</a></li>
</ul>

	<ul id="footer-icons" class="noprint">
	<li id="footer-copyrightico"><a href="https://wikimediafoundation.org/"><img src="/static/images/footer/wikimedia-button.png" srcset="/static/images/footer/wikimedia-button-1.5x.png 1.5x, /static/images/footer/wikimedia-button-2x.png 2x" width="88" height="31" alt="Wikimedia Foundation" loading="lazy" /></a></li>
	<li id="footer-poweredbyico"><a href="https://www.mediawiki.org/"><img src="/static/images/footer/poweredby_mediawiki_88x31.png" alt="Powered by MediaWiki" srcset="/static/images/footer/poweredby_mediawiki_132x47.png 1.5x, /static/images/footer/poweredby_mediawiki_176x62.png 2x" width="88" height="31" loading="lazy"/></a></li>
</ul>

</footer>

<script>(RLQ=window.RLQ||[]).push(function(){mw.config.set({"wgPageParseReport":{"discussiontools":{"limitreport-timeusage":"0.030"},"limitreport":{"cputime":"0.119","walltime":"0.144","ppvisitednodes":{"value":509,"limit":1000000},"postexpandincludesize":{"value":3922,"limit":2097152},"templateargumentsize":{"value":272,"limit":2097152},"expansiondepth":{"value":12,"limit":100},"expensivefunctioncount":{"value":0,"limit":500},"unstrip-depth":{"value":0,"limit":20},"unstrip-size":{"value":12519,"limit":5000000},"timingprofile":["100.00%   62.329      1 -total"," 64.04%   39.918      1 Template:Tracked"," 58.06%   36.189      3 Template:Dir"," 48.80%   30.418      3 Template:Pagelang"," 11.62%    7.245      6 Template:Collapse_top","  4.45%    2.775      6 Template:Collapse_bottom"]},"scribunto":{"limitreport-timeusage":{"value":"0.007","limit":"10.000"},"limitreport-memusage":{"value":521376,"limit":52428800}},"cachereport":{"origin":"labweb1002","timestamp":"20220420191639","ttl":1814400,"transientcontent":false}}});mw.config.set({"wgBackendResponseTime":129,"wgHostname":"labweb1002"});});</script>
</body>
</html>